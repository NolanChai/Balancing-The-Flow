The [official](http://www.premierleague.com/matchday-live/2017/28/manchester-united-vs-chelsea) video is a little confusing, but it appears that he was in fact offside when the goal went in, because the ball had bounced off his teammate's back and therefore into play. However, this doesn't mean that the goal should not have been allowed:

> The Laws of the Game state: “If a player is in an offside position when the ball touches or is played by a team-mate, the player cannot be penalised for being in that position until either he becomes actively involved in play by playing or touching the ball, or he moves into his opponents’ half”.

I would argue that Juan Mata wasn't 'actively involved in play' when the goal went in. The referee was clearly not able to judge this, and so I think it is fair enough for him to let the goal stand.

### Further Thoughts:
It would be interesting to see a more detailed statistical analysis of offside situations (eg how often they are given correctly by the referees). However, my instinct is that most of these decisions are correct and there's not much value in the technology at this point.