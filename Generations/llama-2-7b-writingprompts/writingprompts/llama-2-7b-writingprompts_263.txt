I have to say, this is a nice little problem with the floating-point error that you've described; it looks like I'll probably be able to run some quick tests on the code before I get started. In terms of algorithm design, what would be your next move if the solution wasn't found in your current line of thought?